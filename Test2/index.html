<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Magret de canard (sauce au miel et thym)</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Open+Sans:wght@300&display=swap" rel="stylesheet">
    <script type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "Recipe",
        "name": "Magret de canard (sauce au miel et thym)",
        "recipeIngredient": ["2  magrets de canard", "1 [object Object]  de piment d'espellette", "4 [object Object]  de miel de montagne", "0.25  citron jaune", "20 [object Object]  de fond de veau", "null  Poivre noir", "40 [object Object]  de beurre doux", "null  Sel fin", "4 [object Object]  de vinaigre de vin rouge"]
        }
    </script>


    <script async="async" src="//platform.getbring.com/widgets/import.js"></script>
    <style>
        body { font-family: 'Open Sans', sans-serif; }
        h1, h2, h3, h4 { color: #CB6863; }
        h3 { font-weight: 300; }
        .container {
            display: flex;
            justify-content: space-between;
            margin: 20px;
        }
        .ingredients {
            width: 30%;
            background-color: #FCFCFC;
            padding: 0 35px;
        }
        .preparations {
            width: 70%;
            padding: 0 50px;
        }
        ul {
            list-style-type: disc;
            padding-left: 20px;
            font-size: 16px;
        }
        .instructions {
            font-size: 16px;
        }
        .portion-control {
            text-align: center;
            margin-bottom: 20px;
        }
        .portion-control h4 {
            margin-bottom: 10px;
        }
        .button-container {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .button-container button {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            margin: 0 10px;
            background-color: #FCFCFC;
            color: #CB6863;
            border: 2px solid #CB6863;
            border-radius: 50%;
            font-size: 20px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: 0.3s ease;
        }
        .button-container button:hover {
            color: #F6E2DF;
            border-color: #F6E2DF;
        }
        .button-container input {
            text-align: center;
            width: 60px;
            background-color: #FCFCFC;
            border: none;
            color: #CB6863;
            font-size: 18px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .bring-container {
            margin-bottom: 20px; /* Espacement entre la section Bring et la liste des ingrédients */
        }
        .highlight-quantity {
            color: #CB6863;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="ingredients">
            <h2>Ingrédients</h2>
            <div class="portion-control">
                <h4>Portions</h4>
                <div class="button-container">
                    <button onclick="updatePortions(-1)">-</button>
                    <input type="number" id="portion-input" value="6" readonly>
                    <button onclick="updatePortions(1)">+</button>
                </div>
            </div>
            <div class="bring-container">
                <div id="bring-import-container" data-bring-import data-bring-language="fr" data-bring-theme="light" data-bring-base-quantity="6" data-bring-requested-quantity="6">
                    <a href="https://www.getbring.com">Bring! Einkaufsliste App pour iPhone et Android</a>
                </div>
            </div>
            <ul id="ingredient-list">
                
                    <li><span class="highlight-quantity">2 </span> magrets de canard</li>
                
                    <li><span class="highlight-quantity">1 [object Object]</span>  de piment d'espellette</li>
                
                    <li><span class="highlight-quantity">4 [object Object]</span>  de miel de montagne</li>
                
                    <li><span class="highlight-quantity">0.25 </span> citron jaune</li>
                
                    <li><span class="highlight-quantity">20 [object Object]</span>  de fond de veau</li>
                
                    <li><span class="highlight-quantity">null </span> Poivre noir</li>
                
                    <li><span class="highlight-quantity">40 [object Object]</span>  de beurre doux</li>
                
                    <li><span class="highlight-quantity">null </span> Sel fin</li>
                
                    <li><span class="highlight-quantity">4 [object Object]</span>  de vinaigre de vin rouge</li>
                
            </ul>
        </div>
        <div class="preparations">
            <h1 style="text-align: center; font-weight: bold;">Magret de canard (sauce au miel et thym)</h1>
            <h2>Préparations</h2>
            
                <div class="preparation">
                    <h3>Préparation des magrets</h3>
                    <ul class="instructions">
                        <li>Faire chauffer une poêle progressivement jusqu'à arriver à un feu fort.<br></li><li>Parer les [1] en enlevant l'excédant de gras autour du filet ainsi que les nerf et les membranes. Ensuite, retourner les magret coté gras et faire un quadrillage au couteau en veillant à ne pas entailler la chair. Le fait de parer le magret  permettra une cuisson plus uniforme.<br></li><li>Faire cuire pendant environ 5 minutes à feu moyen / fort les magrets sur le coté gras jusqu'à ce que ce dernier deviennent brun. Ensuite retourner les magrets pour colorer le côté chair pendant environ 15 à 30 secondes.<br></li><li>Laisser reposer les magrets 20 minutes sur une grille afin qu'ils se détendent.<br></li><li>Préchauffer le four à 210° en chaleur statique (pour ne pas dessécher la viande).<br></li>
                    </ul>
                </div>
            
                <div class="preparation">
                    <h3>Sauce au miel & thym</h3>
                    <ul class="instructions">
                        <li>Ajouter [2] dans une casserole sur un feu moyen / fort. Quand le miel commence à bouillir et à changer de couleur déglacer [3] et laisser réduire.<br></li><li>Quand le mélange a bien réduit et devient sirupeux, ajouter [4] et assaisonner de [5], de [6] et de [7] à convenance. Laisser réduire de nouveau de 1 tiers pour retrouver l'état sirupeux du mélange.<br></li><li>Retirer la casserole du feu pour monter la sauce au beurre. Ajouter [8] froid dans la sauce chaude et remuer à l'aide d'un fouet. Pour donner un peu plus de peps à la sauce, ajouter le jus de [9].<br></li>
                    </ul>
                </div>
            
                <div class="preparation">
                    <h3>Cuisson à coeur des magrets</h3>
                    <ul class="instructions">
                        <li>Enfourner 12 à 15 minutes les magret de canard disposés sur une grille au dessus d'un lèche fritte.<br></li><li>Trancher et servir immédiatement les magret de canard.<br></li>
                    </ul>
                </div>
            
        </div>
    </div>
    <script>
        // Récupération des ingrédients pour la mise à jour
        const originalIngredients = [{"quantite":2,"unite":null,"nom":"magrets de canard"},{"quantite":1,"unite":{"id":"selRl6lwc9mIa2cMF","name":"pincée","color":"cyanLight2"},"nom":" de piment d'espellette"},{"quantite":4,"unite":{"id":"selto8y7TqftFH3VM","name":"cuil. à soupe","color":"yellowLight2"},"nom":" de miel de montagne"},{"quantite":0.25,"unite":null,"nom":"citron jaune"},{"quantite":20,"unite":{"id":"selecwlJTr6SuWx3M","name":"cl.","color":"blueLight1"},"nom":" de fond de veau"},{"quantite":null,"unite":null,"nom":["Poivre noir"]},{"quantite":40,"unite":{"id":"selX1UFBTxge4qCde","name":"g.","color":"greenLight2"},"nom":" de beurre doux"},{"quantite":null,"unite":null,"nom":["Sel fin"]},{"quantite":4,"unite":{"id":"selto8y7TqftFH3VM","name":"cuil. à soupe","color":"yellowLight2"},"nom":" de vinaigre de vin rouge"}];
        const crochetIngredients =[{"order":1,"quantity":2,"unit":"","name":"magrets de canard"},{"order":2,"quantity":1,"unit":{"id":"selRl6lwc9mIa2cMF","name":"pincée","color":"cyanLight2"},"name":" de piment d'espellette"},{"order":3,"quantity":4,"unit":{"id":"selto8y7TqftFH3VM","name":"cuil. à soupe","color":"yellowLight2"},"name":" de miel de montagne"},{"order":4,"quantity":0.25,"unit":"","name":"citron jaune"},{"order":5,"quantity":20,"unit":{"id":"selecwlJTr6SuWx3M","name":"cl.","color":"blueLight1"},"name":" de fond de veau"},{"order":6,"quantity":null,"unit":"","name":["Poivre noir"]},{"order":7,"quantity":40,"unit":{"id":"selX1UFBTxge4qCde","name":"g.","color":"greenLight2"},"name":" de beurre doux"},{"order":8,"quantity":null,"unit":"","name":["Sel fin"]},{"order":9,"quantity":4,"unit":{"id":"selto8y7TqftFH3VM","name":"cuil. à soupe","color":"yellowLight2"},"name":" de vinaigre de vin rouge"}]

        function updatePortions(delta) {
            const input = document.getElementById("portion-input");
            let currentValue = parseInt(input.value, 10);
            if (currentValue + delta > 0) {
                input.value = currentValue + delta;

                // Mettre à jour les attributs data-bring-base-quantity et data-bring-requested-quantity avec la nouvelle valeur
                const bringContainer = document.getElementById("bring-import-container");
                bringContainer.setAttribute("data-bring-base-quantity", input.value);
                bringContainer.setAttribute("data-bring-requested-quantity", input.value);

                // Mettre à jour les quantités des ingrédients
                const ingredientList = document.getElementById("ingredient-list");
                ingredientList.innerHTML = ""; // Réinitialiser la liste des ingrédients

                originalIngredients.forEach(ingredient => {
                    // Calculer la nouvelle quantité
                    let newQuantite = (ingredient.quantite * input.value / 6).toFixed(2); // Arrondir à deux décimales
                    ingredientList.innerHTML += `<li><span class="highlight-quantity">${newQuantite} ${ingredient.unite}</span> ${ingredient.nom}</li>`; // Utiliser les backticks ici
                });
            }
        }
        function replaceIngredientPlaceholders() {
            const instructionsElements = document.querySelectorAll('.instructions');

            instructionsElements.forEach(instructionElement => {
                let instructionsHTML = instructionElement.innerHTML;
                console.log("Avant remplacement:", instructionsHTML); // Débogage

                // Itération sur les ingrédients
                crochetIngredients.forEach(ingredient => {
                    // Créer une expression régulière pour trouver les chiffres entre crochets, par exemple [1], [2], etc.
                    const regex = new RegExp("\[" + ingredient.order + "\]", 'g'); // Recherche des numéros entre crochets, comme [1], [2], etc.

                    // Remplacer les occurrences trouvées par la quantité, l'unité et le nom de l'ingrédient
                    instructionsHTML = instructionsHTML.replace(regex, `<span class="highlight-quantity">${ingredient.quantity} ${ingredient.unit}</span> ${ingredient.name}`);
                });

                console.log("Après remplacement:", instructionsHTML); // Débogage
                instructionElement.innerHTML = instructionsHTML; // Mettre à jour le HTML des instructions
            });
        }


    // Appeler la fonction de remplacement des placeholders après le chargement de la page
    window.onload = replaceIngredientPlaceholders;
</script>
</body>
</html>
